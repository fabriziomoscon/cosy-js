(function(){var e=function(t,n){var r=e.resolve(t,n||"/"),i=e.modules[r];if(!i)throw new Error("Failed to resolve module "+t+", tried "+r);var s=e.cache[r],o=s?s.exports:i();return o};e.paths=[],e.modules={},e.cache={},e.extensions=[".js",".coffee",".json"],e._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},e.resolve=function(){return function(t,n){function u(t){var n,i;t=r.normalize(t);if(e.modules[t])return t;for(n=0;n<e.extensions.length;n++){i=e.extensions[n];if(e.modules[t+i])return t+i}}function a(t){var n,i,s,o;t=t.replace(/\/+$/,""),n=r.normalize(t+"/package.json");if(e.modules[n]){i=e.modules[n](),s=i.browserify;if(typeof s=="object"&&s.main){o=u(r.resolve(t,s.main));if(o)return o}else if(typeof s=="string"){o=u(r.resolve(t,s));if(o)return o}else if(i.main){o=u(r.resolve(t,i.main));if(o)return o}}return u(t+"/index")}function f(e,t){var n,r,i,s,o=l(t);for(n=0;n<o.length;n++){r=o[n],i=u(r+"/"+e);if(i)return i;s=a(r+"/"+e);if(s)return s}i=u(e);if(i)return i}function l(e){var t,n,i,s;e==="/"?t=[""]:t=r.normalize(e).split("/"),n=[];for(i=t.length-1;i>=0;i--){if(t[i]==="node_modules")continue;s=t.slice(0,i+1).join("/")+"/node_modules",n.push(s)}return n}var r,i,s,o;n||(n="/");if(e._core[t])return t;r=e.modules.path(),n=r.resolve("/",n),i=n||"/";if(t.match(/^(?:\.\.?\/|\/)/)){s=u(r.resolve(i,t))||a(r.resolve(i,t));if(s)return s}o=f(t,i);if(o)return o;throw new Error("Cannot find module '"+t+"'")}}(),e.alias=function(t,n){var r,i,s,o,u,a=e.modules.path(),f=null;try{f=e.resolve(t+"/package.json","/")}catch(l){f=e.resolve(t,"/")}r=a.dirname(f),i=(Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t})(e.modules);for(s=0;s<i.length;s++)o=i[s],o.slice(0,r.length+1)===r+"/"?(u=o.slice(r.length),e.modules[n+u]=e.modules[r+u]):o===r&&(e.modules[n]=e.modules[r])},function(){var t={},n=typeof window!="undefined"?window:{},r=!1;e.define=function(i,s){var o,u,a;!r&&e.modules.__browserify_process&&(t=e.modules.__browserify_process(),r=!0),o=e._core[i]?"":e.modules.path().dirname(i),u=function(t){var n=e(t,o),r=e.cache[e.resolve(t,o)];return r&&r.parent===null&&(r.parent=a),n},u.resolve=function(t){return e.resolve(t,o)},u.modules=e.modules,u.define=e.define,u.cache=e.cache,a={id:i,filename:i,exports:{},loaded:!1,parent:null},e.modules[i]=function(){return e.cache[i]=a,s.call(a.exports,u,a,a.exports,o,i,t,n),a.loaded=!0,a.exports}}}(),e.define("path",function(e,t,n,r,i,s){function u(e,t){var n,r=[];for(n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}function a(e,t){var n,r,i=0;for(n=e.length;n>=0;n--)r=e[n],r=="."?e.splice(n,1):r===".."?(e.splice(n,1),i++):i&&(e.splice(n,1),i--);if(t)for(;i--;i)e.unshift("..");return e}var o;o=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/,n.resolve=function(){var e,t,n="",r=!1;for(e=arguments.length;e>=-1&&!r;e--){t=e>=0?arguments[e]:s.cwd();if(typeof t!="string"||!t)continue;n=t+"/"+n,r=t.charAt(0)==="/"}return n=a(u(n.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(e){var t=e.charAt(0)==="/",n=e.slice(-1)==="/";return e=a(u(e.split("/"),function(e){return!!e}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(u(e,function(e){return e&&typeof e=="string"}).join("/"))},n.dirname=function(e){var t=o.exec(e)[1]||"",n=!1;return t?t.length===1||n&&t.length<=3&&t.charAt(1)===":"?t:t.substring(0,t.length-1):"."},n.basename=function(e,t){var n=o.exec(e)[2]||"";return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return o.exec(e)[3]||""}}),e.define("__browserify_process",function(e,t,n,r,i,s){var s=t.exports={};s.nextTick=function(){var e,t=typeof window!="undefined"&&window.setImmediate,n=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return t?function(e){return window.setImmediate(e)}:n?(e=[],window.addEventListener("message",function(t){var n;t.source===window&&t.data==="browserify-tick"&&(t.stopPropagation(),e.length>0&&(n=e.shift(),n()))},!0),function(t){e.push(t),window.postMessage("browserify-tick","*")}):function(e){setTimeout(e,0)}}(),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.binding=function(t){if(t==="evals")return e("vm");throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,n="/";s.cwd=function(){return n},s.chdir=function(r){t||(t=e("path")),n=t.resolve(r,n)}}()}),e.define("/lib/cosy.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=e("./core/reader"),i=e("./core/evaluator"),s=e("./core/hashMap").hashMap,o=function(e,t){var s,o,u,a,f=i.use(i.frame(),t),l=[];for(o in t){if(!n.call(t,o))continue;u=t[o],l.push("[data-cosy-"+o+"]")}return a=l.join(","),s=r.read(e,a),i.apply(s,f)};t.exports={up:o,isAwesome:!0,snuggle:e("./snuggle")}}).call(this)}),e.define("/lib/core/reader.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=e("../protocol/element"),i=r.css,s=r.data,o=r.cosy,u=r.attrs,a=e("../protocol/map"),f=a.key,l=a.value,c=e("../protocol/list"),h=c.into,p=c.second,d=c.rest,v=e("./hashMap").hashMap,m=e("./list"),g=m.map,y=m.reduce,b=m.filter,w=e("../protocol/mutable").get,E=e("../dom/reader"),S=function(e,t){var n=/^data-(cosy-(.*))/.exec(f(t)),r=n[2],i=n[1],o=function(e,t){var r={};return n=/^([^-]+)(-(.*))?/.exec(e),n!=null&&n[3]!=null?r[n[1]]=o(n[3],t):r[e]=t,v(r)};return o(r,s(e,i))},x=function(e){return/^data-cosy-/.exec(f(e))!=null},T=function(e){var t=o(e);return t===""&&(t=v({})),t==null&&(t=v({})),new k(h(t,y(h,g(function(t){return S(e,t)},b(x,u(e))))))},N=function(){function e(e){this.root=e.root,this.children=e.children}return e}(),C=function(){function e(e){this.cosy=e.cosy,this.element=e.element}return e}(),k=function(){function e(e){var t,r;for(t in e){if(!n.call(e,t))continue;r=e[t],this[t]=r}}return e}(),L=function(e){return e instanceof k},A=function(e){return e instanceof N},O=function(e){return e instanceof C},M=function(e){return e==null?null:new N({root:new C({cosy:T(e.node),element:e.node}),children:g(M,e.children)})},_=function(e,t){return t==null&&(t="[data-cosy]"),M(E.read(e,t))},D=function(e){return e.root},P=function(e){return e.element},H=function(e){return e.cosy},B=function(e){return e.children};t.exports={read:_,isTree:A,isTreeNode:O,isCosy:L,node:D,cosy:H,children:B,element:P}}).call(this)}),e.define("/lib/protocol/element.js",function(e,t){(function(){"use strict";var n,r=e("../core/protocol"),i=r.defProtocol,s=r.dispatch,o=r.extend,u=e("../core/reference"),a=u.ref,f=u.watchRef,l=e("../core/hashMap").hashMap,c=e("./list"),h=e("./list").into,p=e("../core/list").map,d=e("./mutable"),v=e("../core/native/function"),m=v.isFn,g=v.assertFn,y=e("../core/native/string").assertStr,b=function(e){return e!=null&&e.jquery!=null};t.exports=n=i({attr:s(function(){}),attrs:s(function(){}),children:s(function(){}),cosy:function(e){return n.data(e,"cosy")},css:s(function(){}),data:s(function(){}),text:s(function(){}),value:s(function(){}),parents:s(function(){}),siblings:s(function(){}),matches:s(function(){}),listen:s(function(){}),remove:s(function(){}),append:s(function(){})}),o(d,b,{get:function(e){return e.html()},set:function(e,t){return e.trigger("html"),e.html(t)}}),o(n,b,{attr:function(e,t){return f(d.set(a(),e.attr(y(t))),function(n){return e.attr(t,d.get(n))})},attrs:function(e){var t,n,r,i,s={};if(e[0].attributes!=null){i=e[0].attributes;for(n=0,r=i.length;n<r;n++)t=i[n],s[t.name]=t.value}return l(s)},children:function(e){return e.children()},css:function(e,t){return e.find(y(t,"Invalid selector"))},data:function(e,t){return e.data(y(t))},text:function(e){return f(d.set(a(),e.text()),function(t){return e.text(d.get(t))})},value:function(e){return f(d.set(a(),e.val()),function(t){return e.trigger("value"),e.val(d.get(t))})},parents:function(e,t){return e.parents(y(t,"Invalid selector"))},siblings:function(e,t){return e.siblings(y(t,"Invalid selector"))},matches:function(e,t){return e.is(y(t,"Invalid Selector"))},listen:function(e,t,n){return e.on(t,n)},remove:function(e){return e.trigger("remove"),e.remove()},append:function(e,t){return e.trigger("append"),e.append(t)}}),o(c,b,{first:function(e){return e.length?e.eq(0):null},rest:function(e){return e.length?e.slice(1):null}})}).call(this)}),e.define("/lib/core/protocol.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=[].slice,i=e("./native/function").assertFn,s=function(){function e(e){var t,r;for(r in e){if(!n.call(e,r))continue;t=e[r],this[r]=t,t.setName&&this[r].setName(r)}this.supports=function(){return!1}}return e}(),o=function(e){return new s(e)},u=function(e){var t=null,n=function(){var e=1<=arguments.length?r.call(arguments,0):[];return n.validate.apply(n,e),n.impl.apply(n,e)};return n.setName=function(e){return t=e},n.impl=function(e){throw new Error("Function not implemented "+t+" for "+e)},n.validate=function(){var n=1<=arguments.length?r.call(arguments,0):[];if(n.length!==e.length)throw new Error("Invalid invocation "+t)},n},a=function(e,t,n,s){var o,u;if(e[n]==null)throw new Error("Unknown function "+n);if(e[n].impl==null)throw new Error("Function not extendable "+n);return i(t,"Invalid predicate"),i(s,"Invalid function"),o=e[n].impl,e[n].impl=function(){var e=1<=arguments.length?r.call(arguments,0):[];return t.apply(null,e)?s.apply(null,e):o.apply(null,e)},u=e.supports,e.supports=function(){var e=1<=arguments.length?r.call(arguments,0):[];return t.apply(null,e)?!0:u.apply(null,e)}},f=function(e,t,r){var i,s,o=[];for(s in r){if(!n.call(r,s))continue;i=r[s],o.push(a(e,t,s,i))}return o},l=function(){var e=arguments[0],t=2<=arguments.length?r.call(arguments,1):[];return e.supports.apply(e,t)};t.exports={defProtocol:o,extend:f,dispatch:u,supports:l}}).call(this)}),e.define("/lib/core/native/function.js",function(e,t){(function(){"use strict";var e=function(e){return typeof e=="function"},n=function(t,n){n==null&&(n="Invalid function");if(!e(t))throw new Error(n);return t};t.exports={isFn:e,assertFn:n}}).call(this)}),e.define("/lib/core/reference.js",function(e,t){(function(){"use strict";var n=e("./protocol").extend,r=e("../protocol/mutable"),i=e("./native/function").isFn,s=function(){function e(e){e==null&&(e=null),this.value=e,this.metadata={watches:[]}}return e}(),o=function(e){return new s(e)},u=function(e){return e instanceof s},a=function(e){if(!u(e))throw new Error("Invalid reference");return e},f=function(e){return a(e).value},l=function(e,t){return a(e).value=t,p(e),e},c=function(e,t){return a(e).metadata.watches.push(t),e},h=function(e,t){var n,r,i,s,o;a(e),o=e.metadata.watches;for(r=i=0,s=o.length;i<s;r=++i)n=o[r],n===t&&delete e.metadata.watches[r];return!0},p=function(e){var t,n,r,s=e.metadata.watches;for(n=0,r=s.length;n<r;n++)t=s[n],i(t)&&t(e);return e};n(r,u,{set:function(e,t){return l(e,t)},get:function(e){return f(e)}}),t.exports={ref:o,isRef:u,getRef:f,setRef:l,watchRef:c,notifyRef:p,unwatchRef:h}}).call(this)}),e.define("/lib/protocol/mutable.js",function(e,t){(function(){"use strict";var n,r=e("../core/protocol"),i=r.defProtocol,s=r.dispatch,o=r.extend,u=e("../core/native/string").isStr;t.exports=n=i({set:s(function(){}),get:s(function(){})}),o(n,u,{get:function(e){return e}})}).call(this)}),e.define("/lib/core/native/string.js",function(e,t){(function(){"use strict";var e=function(e){return typeof e=="string"},n=function(t,n){n==null&&(n="Invalid string");if(!e(t))throw new Error(n);return t};t.exports={isStr:e,assertStr:n}}).call(this)}),e.define("/lib/core/hashMap.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=e("../protocol/map"),i=e("../protocol/list"),s=e("./protocol").extend,o=function(){function e(e){var t,r;if(e!=null)for(t in e){if(!n.call(e,t))continue;r=e[t],this[t]=r}}return e}(),u=function(){function e(){}return e}(),a=function(e){var t;for(t in e){if(!n.call(e,t))continue;return!1}return!0},f=function(e){return new o(e)},l=function(e,t){var n=new u;return n[0]=e,n[1]=t,n},c=function(e){return e instanceof o},h=function(e){return e instanceof u};t.exports={hashMap:f},s(r,c,{assoc:function(e,t,n){var r=f(e);return c(e[t])?r[t]=i.into(e[t],n):r[t]=n,r},dissoc:function(e,t){var n=f(e);return delete n[t],a(n)?null:n},get:function(e,t,n){return n==null&&(n=null),e[t]!=null?e[t]:n},find:function(e,t){return e[t]!=null?l(t,e[t]):null}}),s(r,h,{key:function(e){return e[0]},value:function(e){return e[1]}}),s(i,c,{first:function(e){var t,r;for(t in e){if(!n.call(e,t))continue;return r=e[t],l(t,r)}return null},rest:function(e){var t=i.first(e);return t!=null?r.dissoc(e,r.key(t)):null},conj:function(e,t){var n,s,o;return t===null?e:h(t)?r.assoc(e,r.key(t),r.value(t)):(o=i.first(t),n=o[0],s=o[1],i.conj(r.assoc(e,n,s),i.rest(t)))}})}).call(this)}),e.define("/lib/protocol/map.js",function(e,t){(function(){"use strict";var n,r=e("../core/protocol"),i=r.defProtocol,s=r.dispatch,o=r.extend;t.exports=n=i({key:s(function(){}),value:s(function(){}),assoc:s(function(){}),dissoc:s(function(){}),get:s(function(){}),find:s(function(){})})}).call(this)}),e.define("/lib/protocol/list.js",function(e,t){(function(){"use strict";var n,r=e("../core/protocol"),i=r.defProtocol,s=r.dispatch,o=r.extend,u=e("../core/native/array").isArr;t.exports=n=i({first:s(function(){}),second:function(e){return n.first(n.rest(e))},rest:s(function(){}),conj:s(function(){}),cons:function(e,t){return n.conj(t,e)},into:function(e,t){return t!==null?n.into(n.conj(e,n.first(t)),n.rest(t)):e}}),o(n,function(e){return e===null},{first:function(){return null},rest:function(){return null},conj:function(e,t){return[t]}}),o(n,u,{first:function(e){return e.length!=null&&e.length?e[0]:null},rest:function(e){return e.length>1?e.slice(1):null},conj:function(e,t){var n=e.slice(0);return n.push(t),n}})}).call(this)}),e.define("/lib/core/native/array.js",function(e,t){(function(){"use strict";var e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},n=function(t,n){n==null&&(n="Invalid array");if(!e(t))throw new Error(n);return t};t.exports={isArr:e,assertArr:n}}).call(this)}),e.define("/lib/core/list.js",function(e,t){(function(){"use strict";var n=e("../protocol/list"),r=n.first,i=n.rest,s=n.cons,o=e("./lazySeq").lazySeq,u=function(e,t){return t===null?null:s(e(r(t)),o(function(){return u(e,i(t))}))},a=function(e,t,n){var s;return n==null&&(n=null),t===null?n:(s=r(t),n=n!=null?e(s,n):s,a(e,i(t),n))},f=function(e,t){var n;return t===null?null:(n=r(t),n!=null&&e(n)?s(n,o(function(){return f(e,i(t))})):f(e,i(t)))},l=function(e,t){return t===null||e<1?null:s(r(t),o(function(){return l(e-1,i(t))}))},c=function(e,t){var n=function(e,t){return e<1?t:n(e-1,i(t))};return o(function(){return n(e,t)})},h=function(e){var t=[];return v(function(e){return t.push(e)},e),t},p=function(e){var t;while(e!=null)t=e(),e=t!=null?t.recur:void 0;return null},d=function(e){return{recur:e}},v=function(e,t){return t==null?null:p(function(){return e(r(t)),d(function(){return v(e,i(t))})})};t.exports={map:u,reduce:a,filter:f,take:l,drop:c,vec:h,doSeq:v}}).call(this)}),e.define("/lib/core/lazySeq.js",function(e,t){(function(){"use strict";var n=e("../protocol/list"),r=e("./protocol").extend,i=function(){function e(e,t){this.promise=e,this.head=t!=null?t:t=null}return e}(),s=function(e){return e instanceof i},o=function(e,t){return new i(e,t)};r(n,s,{first:function(e){var t;return e.head==null&&(t=e.promise(),e.head=n.first(t),e.promise=function(){return n.rest(t)}),e.head},rest:function(e){return n.first(e),e.promise()},conj:function(e,t){return e.head=t,e}}),t.exports={lazySeq:o}}).call(this)}),e.define("/lib/dom/reader.js",function(e,t){(function(){"use strict";var n=e("../protocol/element"),r=n.css,i=n.parents,s=n.matches,o=e("../core/list"),u=o.filter,a=o.map,f=e("../protocol/list").first,l=function(e,t,n){var r;return t==null?!1:(r=f(i(t,n)),r!=null?e[0]===r[0]:!0)},c=function(e,t){var n;return e===null?null:(n=a(function(e){return c(e,t)},u(function(n){return l(e,n,t)},r(e,t))),{node:e,children:n})};t.exports={read:c}}).call(this)}),e.define("/lib/core/evaluator.js",function(e,t){(function(){"use strict";var n,r,i,s=[].slice,o={}.hasOwnProperty,u=e("./protocol"),a=u.defProtocol,f=u.dispatch,l=u.extend,c=u.supports,h=e("../protocol/list"),p=e("../protocol/map"),d=p.assoc,v=p.get,m=e("./hashMap").hashMap,g=e("./native/string"),y=g.isStr,b=g.assertStr,w=e("./list"),E=w.doSeq,S=w.map,x=w.vec,T=w.filter,N=e("./native/function").assertFn,C=e("./reader"),k=C.isTreeNode,L=C.isTree,A=C.isCosy,O=C.node,M=C.children,_=C.cosy,D=C.element,P=function(e){return b(e).split(/\s/)},H=function(e,t){var n=h.first(t),r=h.rest(t),s=v(e,n);return s&&r?H(i(e,s),r):s},B=function(e,t){var n,r;if(!y(t))return t;t=t.replace(/^'(.*)'$/,'"$1"'),r=H(e,t.split(/[.]/));if(r==null){if(!/^(true|false|[\d"[{])/i.exec(t))throw n="",e.__node!=null&&(n=" at "+e.__node[0].toString()),new Error("Symbol "+t+" not found"+n);r=JSON.parse(t)}return r},j=function(e,t){var n,r,i,o;return y(e)&&(e=P(e)),i=B(t,h.first(e)),N(i,"Unknown function "+h.first(e)),o=function(e){return i.raw!=null&&i.raw.exec(e)?e:B(t,e)},r=function(e){return e!=null&&e!==""},n=x(S(o,T(r,h.rest(e)))),v(t,"debug")&&console.log([h.first(e)].concat(n)),i.apply(null,[t].concat(s.call(n)))},F=a({apply:f(function(){})});l(F,function(e){return e===null},{apply:function(e,t){return t}}),l(F,y,{apply:function(e,t){return j(e,t)}}),r=function(e,t){var n,i,s;t==null&&(t=""),n=[];if(y(e))n.push(t+e);else for(i in e){if(!o.call(e,i))continue;s=e[i],n=n.concat(r(s,t+i+" "))}return n},l(F,A,{apply:function(e,t){var n,i,s,o,u=r(e);for(s=0,o=u.length;s<o;s++)n=u[s],i=F.apply(n,t),i!=null&&(t=i);return t}}),l(F,k,{apply:function(e,t){var n=d(t,"__node",D(e));return F.apply(_(e),n)}}),l(F,function(e){return c(h,e)},{apply:function(e,t){return E(function(e){return F.apply(e,t)},e),t}}),l(F,L,{apply:function(e,t){var n,r=function(){};return t=d(t,"__continue",function(){return r()}),n=F.apply(O(e),t),n.__parent=n,(n!=null?n.__delay:void 0)!=null?r=function(){return delete n.__delay,delete t.__continue,F.apply(M(e),n)}:F.apply(M(e),n),t}}),i=function(e,t){return h.into(e,m(t))},n=function(){return m({use:i})},t.exports={apply:F.apply,use:i,frame:n,evaluate:j}}).call(this)}),e.define("/lib/snuggle.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=e("./core/evaluator"),i=e("./core/reader"),s=e("./core/reference").ref,o=e("./core/hashMap").hashMap,u=e("./protocol/map").assoc,a=e("./snuggle/core"),f=e("./snuggle/cosy"),l=e("./snuggle/control"),c=function(e,t,i,o){var h,p,d;o==null&&(o=!1),h=r.frame();for(p in i){if(!n.call(i,p))continue;d=i[p];if(a[p]!=null)throw new Error("Cannot overwrite "+p+" in core");a[p]=d}return h=u(h,"namespace",a),h=u(h,"cosy",l),h=r.use(h,f),h=r.use(h,t),h=u(h,"global",s({})),h=u(h,"debug",o),c.to(e,h)};c.to=function(e,t){var s,o,u,a=[];for(s in f){if(!n.call(f,s))continue;o=f[s],a.push("[data-cosy-"+s+"]")}return u=a.join(","),t.__selector=u,e.each(function(e,n){var s=i.read($(n),u);return r.apply(s,t)})},t.exports={up:c}}).call(this)}),e.define("/lib/snuggle/core.js",function(e,t){(function(){"use strict";var n=e("./core/query"),r=e("./core/reference"),i=e("./core/template");t.exports={container:n.container,role:n.role,roles:n.roles,query:n.query,list:e("./core/list"),onEvent:n.onEvent,on:n.on,set:r.set,get:r.get,notify:r.notify,copy:r.copy,form:e("./core/form"),html:e("./core/html"),state:e("./core/state").state,template:i.template,render:i.render,renderRaw:i.renderRaw,global:e("./core/global"),watch:r.watch,watchRef:r.watchRef}}).call(this)}),e.define("/lib/snuggle/core/query.js",function(e,t){(function(){"use strict";var e=[].slice,n=function(t,n){return function(){var r=1<=arguments.length?e.call(arguments,0):[];return n.apply(t,r)}},r=function(e,t){return t==null&&(t=this.element),t.closest("[data-container="+e+"]")},i=function(e,t){return t==null&&(t=this.element),t.find("[data-role="+e+"]")},s=function(e,t){return i.call(this,e,t).eq(0)},o=function(e){return $(e)},u=function(e){return function(t){return e({event:t,element:$(t.target),stop:function(){return t.preventDefault()}})}},a=function(e,t,n,r){return e.on(n,"[data-role="+t+"]",u(r))},f=function(e,t,n){return e.on(t,u(n))},l=function(){var t=1<=arguments.length?e.call(arguments,0):[];return t.length===2?f.apply(null,[this.element].concat(e.call(t))):a.apply(null,[this.element].concat(e.call(t)))},c=!1,h=function(){var t=1<=arguments.length?e.call(arguments,0):[];return c===!1&&(console.log("`on` is deprecated, please use `onEvent`"),c=!0),l.apply(this,t)};t.exports={container:r,role:s,roles:i,query:o,onEvent:l,on:h}}).call(this)}),e.define("/lib/snuggle/core/reference.js",function(e,t){(function(){"use strict";var n=e("../../protocol/mutable"),r=n.set,i=n.get,s=e("../../core/reference"),o=s.watchRef,u=s.unwatchRef,a=function(e,t){return r(t,i(e))},f=function(e){return a(e,e)},l=function(e,t){return c.call(this,e,function(){return t(i(e))})},c=function(e,t){return this.destructors.push(function(){return u(e,t)}),o(e,t)};t.exports={set:r,get:i,copy:a,notify:f,watch:l,watchRef:c}}).call(this)}),e.define("/lib/snuggle/core/template.js",function(e,t){(function(){"use strict";var n=e("../../protocol/template").render,r=e("../../template/hogan"),i=e("../../core/evaluator"),s=e("../../core/reader"),o=e("./html"),u=function(e,t){var n,i,s,o;e==null&&(e="template"),t==null&&(t=this.element),s=t.find("script[data-id="+e+"]").eq(0);if("text/mustache"===s.attr("type")){i=s.data("partial");if(i){n=(o=this.frame.partials)!=null?o[i]:void 0;if(n==null)throw new Error("Partial not found "+i);return r.tmpl(n)}return r.tmpl(s.html())}throw new Error("Unkown type for template "+e)},a=function(e,t){var r,u,a;return o=n(e,t),a=/^<.+>$/i.test($.trim(o.replace(/[\r\n]/gm," "))),a?u=$(o):u=this.html.span({},o),r=s.read(u,this.frame.__selector),i.apply(r,this.frame),u},f=function(e,t){return n(e,t)};t.exports={template:u,render:a,renderRaw:f}}).call(this)}),e.define("/lib/protocol/template.js",function(e,t){(function(){"use strict";var n,r,i=e("../core/protocol"),s=i.defProtocol,o=i.dispatch,u=i.extend,a=e("../core/native/string").isStr;t.exports=r=s({render:o(function(){})}),u(r,a,{render:function(e){return e}}),n=function(e){return e!=null&&e.jquery!=null},u(r,n,{render:function(e){return e}})}).call(this)}),e.define("/lib/template/hogan.js",function(e,t){(function(){"use strict";var n=e("../core/native/object").assertObj,r=e("../core/native/string").assertStr,i=e("../core/protocol").extend,s=e("hogan.js"),o=e("../protocol/template"),u=function(){function e(e){r(e,"Invalid template string"),this.template=s.compile(e)}return e}(),a=function(e){return new u(e)},f=function(e){return e instanceof u},l=function(e){if(!f(e))throw new Error("Invalid template");return e},c=function(e,t){return n(t,"Invalid context"),l(e).template.render(t)};i(o,f,{render:function(e,t){return c(e,t)}}),t.exports={tmpl:a,isTmpl:f,renderTmpl:c}}).call(this)}),e.define("/lib/core/native/object.js",function(e,t){(function(){"use strict";var n=e("./array").isArr,r=function(e){return e!=null&&typeof e=="object"&&!n(e)},i=function(e,t){t==null&&(t="Invalid object");if(!r(e))throw new Error(t);return e};t.exports={isObj:r,assertObj:i}}).call(this)}),e.define("/node_modules/hogan.js/package.json",function(e,t){t.exports={main:"./lib/hogan.js"}}),e.define("/node_modules/hogan.js/lib/hogan.js",function(e,t){var n=e("./compiler");n.Template=e("./template").Template,t.exports=n}),e.define("/node_modules/hogan.js/lib/compiler.js",function(e,t,n){(function(e){function u(e){e.n.substr(e.n.length-1)==="}"&&(e.n=e.n.substring(0,e.n.length-1))}function a(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function f(e,t,n){var r,i;if(t.charAt(n)!=e.charAt(0))return!1;for(r=1,i=e.length;r<i;r++)if(t.charAt(n+r)!=e.charAt(r))return!1;return!0}function l(e,t,n,r){var i=[],s=null,o=null;while(e.length>0){o=e.shift();if(o.tag=="#"||o.tag=="^"||c(o,r))n.push(o),o.nodes=l(e,o.tag,n,r),i.push(o);else{if(o.tag=="/"){if(n.length===0)throw new Error("Closing tag without opener: /"+o.n);s=n.pop();if(o.n!=s.n&&!h(o.n,s.n,r))throw new Error("Nesting error: "+s.n+" vs. "+o.n);return s.end=o.i,i}i.push(o)}}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return i}function c(e,t){var n,r;for(n=0,r=t.length;n<r;n++)if(t[n].o==e.n)return e.tag="#",!0}function h(e,t,n){var r,i;for(r=0,i=n.length;r<i;r++)if(n[r].c==e&&n[r].o==t)return!0}function p(e){return'i = i || "";var b = i + "";var _ = this;'+m(e)+"return b;"}function d(e){return e.replace(s,"\\\\").replace(n,'\\"').replace(r,"\\n").replace(i,"\\r")}function v(e){return~e.indexOf(".")?"d":"f"}function m(e){var t,n,r,i="";for(t=0,n=e.length;t<n;t++)r=e[t].tag,r=="#"?i+=g(e[t].nodes,e[t].n,v(e[t].n),e[t].i,e[t].end,e[t].otag+" "+e[t].ctag):r=="^"?i+=y(e[t].nodes,e[t].n,v(e[t].n)):r=="<"||r==">"?i+=b(e[t]):r=="{"||r=="&"?i+=w(e[t].n,v(e[t].n)):r=="\n"?i+=S('"\\n"'+(e.length-1==t?"":" + i")):r=="_v"?i+=E(e[t].n,v(e[t].n)):r===undefined&&(i+=S('"'+d(e[t])+'"'));return i}function g(e,t,n,r,i,s){return"if(_.s(_."+n+'("'+d(t)+'",c,p,1),'+"c,p,0,"+r+","+i+', "'+s+'")){'+"b += _.rs(c,p,"+'function(c,p){ var b = "";'+m(e)+"return b;});c.pop();}"+'else{b += _.b; _.b = ""};'}function y(e,t,n){return"if (!_.s(_."+n+'("'+d(t)+'",c,p,1),c,p,1,0,0,"")){'+m(e)+"};"}function b(e){return'b += _.rp("'+d(e.n)+'",c,p,"'+(e.indent||"")+'");'}function w(e,t){return"b += (_."+t+'("'+d(e)+'",c,p,0));'}function E(e,t){return"b += (_.v(_."+t+'("'+d(e)+'",c,p,0)));'}function S(e){return"b += "+e+";"}var t=/\S/,n=/\"/g,r=/\n/g,i=/\r/g,s=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};e.scan=function(e,n){function E(){d.length>0&&(v.push(new String(d)),d="")}function S(){var e,n=!0;for(e=y;e<v.length;e++){n=v[e].tag&&o[v[e].tag]<o._v||!v[e].tag&&v[e].match(t)===null;if(!n)return!1}return n}function x(e,t){var n,r;E();if(e&&S())for(n=y;n<v.length;n++)v[n].tag||((r=v[n+1])&&r.tag==">"&&(r.indent=v[n].toString()),v.splice(n,1));else t||v.push({tag:"\n"});m=!1,y=v.length}function T(e,t){var n="="+w,r=e.indexOf(n,t),i=a(e.substring(e.indexOf("=",t)+1,r)).split(" ");return b=i[0],w=i[1],r+n.length-1}var r=e.length,i=0,s=1,l=2,c=i,h=null,p=null,d="",v=[],m=!1,g=0,y=0,b="{{",w="}}";n&&(n=n.split(" "),b=n[0],w=n[1]);for(g=0;g<r;g++)c==i?f(b,e,g)?(--g,E(),c=s):e.charAt(g)=="\n"?x(m):d+=e.charAt(g):c==s?(g+=b.length-1,p=o[e.charAt(g+1)],h=p?e.charAt(g+1):"_v",h=="="?(g=T(e,g),c=i):(p&&g++,c=l),m=g):f(w,e,g)?(v.push({tag:h,n:a(d),otag:b,ctag:w,i:h=="/"?m-w.length:g+b.length}),d="",g+=w.length-1,c=i,h=="{"&&(w=="}}"?g++:u(v[v.length-1]))):d+=e.charAt(g);return x(m,!0),v},e.generate=function(t,n,r){return r.asString?"function(c,p,i){"+t+";}":new e.Template(new Function("c","p","i",t),n,e)},e.parse=function(e,t){return t=t||{},l(e,"",[],t.sectionTags||[])},e.cache={},e.compile=function(e,t){var n,r;return t=t||{},n=e+"||"+!!t.asString,r=this.cache[n],r?r:(r=this.generate(p(this.parse(this.scan(e,t.delimiters),t)),e,t),this.cache[n]=r)}})(typeof n!="undefined"?n:Hogan)}),e.define("/node_modules/hogan.js/lib/template.js",function(e,t,n){var r={};(function(e){function a(e){return e=String(e===null||e===undefined?"":e),o.test(e)?e.replace(t,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(i,"&#39;").replace(s,"&quot;"):e}var t,n,r,i,s,o,u;e.Template=function f(e,t,n){e&&(this.r=e),this.c=n,this.text=t||""},e.Template.prototype={r:function(){return""},v:a,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,r){var i=n[e];return i?(this.c&&typeof i=="string"&&(i=this.c.compile(i)),i.ri(t,n,r)):""},rs:function(e,t,n){var r,i="",s=e[e.length-1];if(!u(s))return i=n(e,t);for(r=0;r<s.length;r++)e.push(s[r]),i+=n(e,t),e.pop();return i},s:function(e,t,n,r,i,s,o){var a;return u(e)&&e.length===0?!1:(typeof e=="function"&&(e=this.ls(e,t,n,r,i,s,o)),a=e===""||!!e,!r&&a&&t&&t.push(typeof e=="object"?e:t[t.length-1]),a)},d:function(e,t,n,r){var i,s=e.split("."),o=this.f(s[0],t,n,r),a=null;if(e==="."&&u(t[t.length-2]))return t[t.length-1];for(i=1;i<s.length;i++)o&&typeof o=="object"&&s[i]in o?(a=o,o=o[s[i]]):o="";return r&&!o?!1:(!r&&typeof o=="function"&&(t.push(a),o=this.lv(o,t,n),t.pop()),o)},f:function(e,t,n,r){var i,s=!1,o=null,u=!1;for(i=t.length-1;i>=0;i--){o=t[i];if(o&&typeof o=="object"&&e in o){s=o[e],u=!0;break}}return u?(!r&&typeof s=="function"&&(s=this.lv(s,t,n)),s):r?!1:""},ho:function(e,t,n,r,i){var s=this.c,o=e.call(t,r,function(e){return s.compile(e,{delimiters:i}).render(t,n)}),u=s.compile(o.toString(),{delimiters:i}).render(t,n);return this.b=u,!1},b:"",ls:function(e,t,n,r,i,s,o){var u=t[t.length-1],a=null;if(!r&&this.c&&e.length>0)return this.ho(e,u,n,this.text.substring(i,s),o);a=e.call(u);if(typeof a=="function"){if(r)return!0;if(this.c)return this.ho(a,u,n,this.text.substring(i,s),o)}return a},lv:function(e,t,n){var r=t[t.length-1],i=e.call(r);return typeof i=="function"&&(i=i.call(r)),i=i.toString(),this.c&&~i.indexOf("{{")?this.c.compile(i).render(r,n):i}},t=/&/g,n=/</g,r=/>/g,i=/\'/g,s=/\"/g,o=/[&<>\"\']/,u=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}})(typeof n!="undefined"?n:r)}),e.define("/lib/snuggle/core/html.js",function(e,t,n){(function(){"use strict";var e,t,r,i=function(e,t,n){var r=$("<"+e+" />");return r.attr(t),r.html(n),r},s=["a","abbr","acronym","address","applet","area","b","base","basefont","bdo","big","blockquote","body","br","button","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","fieldset","font","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","hr","html","i","iframe","img","input","ins","isindex","kbd","label","legend","li","link","map","menu","meta","noframes","noscript","object","ol","optgroup","option","p","param","pre","q","s","samp","script","select","small","span","strike","strong","style","sub","sup","table","tbody","td","textarea","tfoot","th","thead","title","tr","tt","u","ul","var"],o=function(e){return n[e]=function(t,n){return i(e,t,n)}};for(t=0,r=s.length;t<r;t++)e=s[t],o(e)}).call(this)}),e.define("/lib/snuggle/core/list.js",function(e,t){(function(){"use strict";var n=e("../../core/native/array").isArr,r=e("../../core/collection").isCollection,i=e("../../core/reference").isRef,s=e("../../protocol/mutable"),o=s.get,u=s.set,a=function(e){return n(e)||r(e)},f=function(e){return i(e)?f(o(e)):e.length!=null?e.length:0},l=function(e,t){var n;return i(e)?(n=o(e)||[],u(e,n.concat([t]))):e.push(t)},c=function(e,t){var n,r,s,a,f,l,h;if(i(e))return r=o(e),c(r,t),u(e,r);h=[];for(n=a=0,f=e.length;a<f;n=++a)s=e[n],h.push(t===s?([].splice.apply(e,[n,n-n+1].concat(l=[])),l):void 0);return h},h=function(e,t){var n,r;return i(e)?(n=o(e),h(n,t),u(e,n)):([].splice.apply(e,[t,t-t+1].concat(r=[])),r)},p=function(e,t){var n,r,s;if(e==null)return!1;if(i(e))return p(o(e),t);for(r=0,s=e.length;r<s;r++){n=e[r];if(t===n)return!0}return!1};t.exports={count:f,isList:a,push:l,remove:h,removeItem:c,contains:p}}).call(this)}),e.define("/lib/core/collection.js",function(e,t){(function(){"use strict";var n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},s=[].slice,o=e("./native/array").isArr,u=e("./native/function").isFn,a=e("../protocol/mutable"),f=e("./list"),l=f.vec,c=f.map,h=e("./reference"),p=function(e){return h.isRef(e)?e:h.ref(e)},d=function(e,t){var n,r,i,s=[];for(r=0,i=e.length;r<i;r++)n=e[r],s.push(typeof n=="function"?n(t):void 0);return s},v=function(e){function t(e){var r;this.ref=e,this.onUpdate=n(this.onUpdate,this),this.onRemove=n(this.onRemove,this),this.onPrepend=n(this.onPrepend,this),this.onAppend=n(this.onAppend,this),this.removeAll=n(this.removeAll,this),this.remove=n(this.remove,this),this.removeFn=n(this.removeFn,this),this.removeItem=n(this.removeItem,this),this.indexOf=n(this.indexOf,this),this.splice=n(this.splice,this),this.shift=n(this.shift,this),this.pop=n(this.pop,this),this.push=n(this.push,this),t.__super__.constructor.call(this),r=l(c(p,a.get(this.ref))),Array.prototype.push.apply(this,r),this.append=[],this.prepend=[],this.removed=[],this.update=[]}return i(t,e),t.prototype.push=function(e){var n=t.__super__.push.call(this,p(e));return d(this.append,this.length-1),h.notifyRef(this.ref),n},t.prototype.pop=function(){var e=t.__super__.pop.call(this);if(e!=null)return d(this.removed,e),h.notifyRef(this.ref),a.get(e)},t.prototype.unshift=function(e){var n=t.__super__.unshift.call(this,p(e));return d(this.prepend,0),h.notifyRef(this.ref),n},t.prototype
.shift=function(){var e=t.__super__.shift.call(this);if(e!=null)return d(this.removed,e),h.notifyRef(this.ref),a.get(e)},t.prototype.splice=function(){var e,n,r,i,o,u,f=1<=arguments.length?s.call(arguments,0):[],l=t.__super__.splice.apply(this,f);if(l!=null){for(n=0,i=l.length;n<i;n++)e=l[n],d(this.removed,e);h.notifyRef(this.ref),u=[];for(r=0,o=l.length;r<o;r++)e=l[r],u.push(a.get(e));return u}},t.prototype.indexOf=function(e){var t,n,r,i;if(h.isRef(e))return this.indexOf(a.get(e));for(t=r=0,i=this.length;r<i;t=++r){n=this[t];if(e===a.get(n))return t}},t.prototype.removeItem=function(e){var t,n,r=this.indexOf(e);if(r!=null)return t=this[r],[].splice.apply(this,[r,r-r+1].concat(n=[])),n,d(this.removed,t),!0},t.prototype.removeFn=function(e){var t,n,r,i,s,o=!1,u=[];for(n=0,i=this.length;n<i;n++)t=this[n],e(a.get(t))&&u.push(t);for(r=0,s=u.length;r<s;r++)t=u[r],this.removeItem(t),o=!0;return o},t.prototype.remove=function(e){var t;return u(e)?t=this.removeFn(e):t=this.removeItem(e),t&&h.notifyRef(this.ref),t},t.prototype.removeAll=function(){return this.length>0?this.remove(function(){return!0}):d(this.update)},t.prototype.onAppend=function(e){return this.append.push(e)},t.prototype.onPrepend=function(e){return this.prepend.push(e)},t.prototype.onRemove=function(e){return this.removed.push(e)},t.prototype.onUpdate=function(e){return this.update.push(e)},t}(Array),m=function(e){return new v(e)},g=function(e){return e instanceof v};t.exports={collection:m,isCollection:g}}).call(this)}),e.define("/lib/snuggle/core/form.js",function(e,t){(function(){"use strict";var n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},r=e("../../protocol/element").children,i=e("../../core/list"),s=i.filter,o=i.map,u=i.reduce,a=e("../../protocol/list").into,f=e("../../core/hashMap").hashMap,l=["input","select","textarea","button"],c=function(e){var t,r;return e[0]==null?!1:(t=e.attr("name")||e.attr("id"),(r=e[0].tagName.toLowerCase(),n.call(l,r)>=0)&&t)},h=function(e){return e==null&&(e=this.element),e.is("form")?e:e.find("form").eq(0)},p=function(e){return function(t){return e({event:t,element:$(t.target),stop:function(){return t.preventDefault()}})}},d=function(e,t){var n=h.call(this,t);return n.submit(p(e))},v=function(e,t){var n=h.call(this,t);return n.on("reset",p(e))},m=function(e){var t;return e==null&&(e=this.element),t=function(e){var t={},n=e.attr("name")||e.attr("id");return t[n]=e.val(),f(t)},u(a,o(t,s(c,o($,e.find(l.join(", ")).toArray()))))};t.exports={submit:d,reset:v,toObject:m,getForm:h}}).call(this)}),e.define("/lib/snuggle/core/state.js",function(e,t){(function(){"use strict";var n=e("../../core/reference"),r=n.ref,i=n.watchRef,s=e("../../protocol/mutable"),o=s.get,u=s.set,a=function(e,t){return e.addClass("is-not-"+t),e.removeClass("is-"+t),e.removeAttr("data-is-"+t)},f=function(e,t){return e.addClass("is-"+t),e.removeClass("is-not-"+t),e.attr("data-is-"+t,!0)},l=function(){function e(e,t,n){var s=r();this.on=function(){return u(s,!0)},this.off=function(){return u(s,!1)},this.toggle=function(){return u(s,!o(s))},this.get=function(){return o(s)},i(s,function(){return o(s)?f(e,t):a(e,t)}),u(s,n)}return e}(),c=function(e,t,n){return n==null&&(n=this.element),new l(n,e,t)};t.exports={state:c}}).call(this)}),e.define("/lib/snuggle/core/global.js",function(e,t){(function(){"use strict";var n=e("../../core/reference").ref,r=e("../../protocol/map"),i=e("../../protocol/mutable"),s=function(e){var t=i.get(r.get(this.frame,"global")),n=t[e];if(n!=null)return i.get(n);throw new Error("Unknown ref")},o=function(e){var t=i.get(r.get(this.frame,"global")),s=t[e];return s==null&&(s=n()),t[e]=s,i.set(r.get(this.frame,"global"),t),s},u=function(e,t){var n=o.call(this,e);return i.set(n,t)};t.exports={getOrInitRef:o,get:s,set:u}}).call(this)}),e.define("/lib/snuggle/cosy.js",function(e,t){(function(){"use strict";var n=[].slice,r=e("../core/evaluator").use,i=!1,s=function(){var e=1<=arguments.length?n.call(arguments,0):[];return i===!1&&(console.log("`ns` is deprecated, please use `import`"),i=!0),r.apply(null,e)},o=function(){var e=arguments[0],t=arguments[1],i=3<=arguments.length?n.call(arguments,2):[];return t==null?e:(e=r(e,t),o.apply(null,[e].concat(n.call(i))))};t.exports={control:e("./cosy/control"),"class":e("./cosy/class"),props:e("./cosy/props"),attach:e("./cosy/attach"),call:e("./cosy/call"),partial:e("./cosy/partial").partial,"import":o,ns:s}}).call(this)}),e.define("/lib/snuggle/cosy/control.js",function(e,t){(function(){"use strict";var n={}.hasOwnProperty,r=[].slice,i=function(e,t){return function(){return e.apply(t,arguments)}},s=e("../../protocol/map"),o=e("../../protocol/mutable"),u=e("../../core/reference"),a=u.isRef,f=u.watchRef,l=e("../../core/evaluator"),c=l.evaluate,h=l.use,p=e("../../core/native/function").isFn,d=function(e,t){var n,r,i,s=[];for(r=0,i=e.length;r<i;r++)n=e[r],s.push(a(n)&&n.metadata.controls[t].passRef!==!0?o.get(n):n);return s},v=function(e,t,i){var s,o,u=[];for(s in t){if(!n.call(t,s))continue;o=t[s],u.push(function(t,n){return p(n)?e[t]=function(){var e=1<=arguments.length?r.call(arguments,0):[];return n.apply(i,e)}:(e[t]={},v(e[t],n,i))}(s,o))}return u},m=function(e,t){if(e==null)return;if(e.__control!=null)return e.__control.children.push(t);if(e!==e.__parent)return m(e.__parent,t)},g=0,y=function(){function e(e,t,n){var o,u,f,l,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D=this;this.frame=e,this.destroy=i(this.destroy,this),this.empty=i(this.empty,this);if(!p(t)){if(this.frame.__parentNS!=null)return c(["control",t].concat(n),h(this.frame,this.frame.__parentNS));throw new Error(t+" control not found")}g+=1,this.instance=g,this.destructors=[],this.children=[],m(this.frame,this),this.frame.__control=this,o=function(){var e=d(n,D.instance);return t.apply(D,e)},l=s.get(this.frame,"namespace"),v(this,l,this),this.cosy={control:function(){var t=1<=arguments.length?r.call(arguments,0):[];return c(["control"].concat(t),e)},cmd:function(t,n){var r=s.assoc(e,"__node",t);return c(n,r)}},this.props=s.get(this.frame,"refs"),this.element=s.get(this.frame,"__node");for(f=x=0,N=n.length;x<N;f=++x)u=n[f],y=/^([&])?(@|%)(.*)$/.exec(u),a(n[f])&&((A=(b=n[f].metadata).controls)==null&&(b.controls={}),(O=(w=n[f].metadata.controls)[k=this.instance])==null&&(w[k]={}),n[f].metadata.controls[this.instance].passRef=!0),y!=null&&y[2]==="@"&&y[3]!=null&&(n[f]=this.props[y[3]]),y!=null&&y[2]==="%"&&y[3]!=null&&(n[f]=this.global.getOrInitRef(y[3])),a(n[f])&&((M=(E=n[f].metadata).controls)==null&&(E.controls={}),(_=(S=n[f].metadata.controls)[L=this.instance])==null&&(S[L]={}),y!=null&&y[1]==="&"&&(n[f].metadata.controls[this.instance].passRef=!0),this.destructors.push(function(e,t){return function(){if(e[t]!=null)return delete e[t]}}(n[f].metadata.controls,this.instance)));for(T=0,C=n.length;T<C;T++)u=n[T],a(u)&&this.watchRef(u,o);this.isInitialising=!0,o(),this.isInitialising=!1}return e.prototype.empty=function(){var e;while(e=this.children.pop())e.destroy();return this.element.html("")},e.prototype.destroy=function(){var e,t,n,r;this.empty(),r=this.destructors;for(t=0,n=r.length;t<n;t++)e=r[t],e();return this.element.remove()},e}(),b=function(){var e=arguments[0],t=arguments[1],n=3<=arguments.length?r.call(arguments,2):[];return new y(e,t,n),e};b.raw=/^&?[%@].+$/,t.exports=b}).call(this)}),e.define("/lib/snuggle/cosy/class.js",function(e,t){(function(){"use strict";var n=[].slice,r=e("../../core/native/function").isFn,i=e("../../core/evaluator"),s=i.evaluate,o=i.use,u=function(e){return function(){var t=1<=arguments.length?n.call(arguments,0):[];if(this.isInitialising)return this.isInitialising=!1,this.frame["this"]=function(e,t,n){var r,i,s;return n.prototype=e.prototype,r=new n,i=e.apply(r,t),s=typeof i,s=="object"||s=="function"?i||r:r}(e,[this].concat(n.call(t)),function(){});if(r(this.update))return this.update.apply(this,t)}},a=function(){var e=arguments[0],t=arguments[1],r=3<=arguments.length?n.call(arguments,2):[],i=u(t);return e.control.apply(e,[e,i].concat(n.call(r)))};a.raw=/^&?[%@].+$/,t.exports=a}).call(this)}),e.define("/lib/snuggle/cosy/props.js",function(e,t){(function(){"use strict";var n=[].slice,r=e("../../core/reference"),i=r.ref,s=r.isRef,o=e("../../protocol/map"),u=o.get,a=o.assoc,f=function(){var e,t,r,o=arguments[0],a=2<=arguments.length?n.call(arguments,1):[],f=u(o,"refs")||{};for(t=0,r=a.length;t<r;t++)e=a[t],s(f[e])||(f[e]=i());return o.refs=f,o};f.raw=/^[^"'].*$/,t.exports=f}).call(this)}),e.define("/lib/snuggle/cosy/attach.js",function(e,t){(function(){"use strict";var e=function(e,t){return e.__node[0].frame=e,t==="delay"&&(e.__delay=!0),e};t.exports=e}).call(this)}),e.define("/lib/snuggle/cosy/call.js",function(e,t){(function(){"use strict";var e=[].slice,n=function(){var t=arguments[0],n=arguments[1],r=3<=arguments.length?e.call(arguments,2):[];return n.apply(null,[t.__node].concat(e.call(r))),t};t.exports=n}).call(this)}),e.define("/lib/snuggle/cosy/partial.js",function(e,t){(function(){"use strict";var e=function(e,t){var n,r;return(r=(n=e.__parent).partials)==null&&(n.partials={}),e.__parent.partials[t]=e.__node.html(),e};e.raw=/^[^"'].*$/,t.exports={partial:e}}).call(this)}),e.define("/lib/snuggle/control.js",function(e,t){(function(){"use strict";t.exports={List:e("./control/list").List,Tree:e("./control/tree").Tree}}).call(this)}),e.define("/lib/snuggle/control/list.js",function(e,t){(function(){"use strict";var n=function(e,t){return function(){return e.apply(t,arguments)}},r=e("../../core/collection"),i=r.collection,s=r.isCollection,o=e("../../protocol/mutable"),u=e("../../core/reference"),a=u.isRef,f=u.ref,l=u.notifyRef,c=0,h=function(){function e(e,t,r){var u,l,h,p,d,v,m,g,y,b,w;this.control=e,this.itemTemplate=r,this.renderAll=n(this.renderAll,this),this.remove=n(this.remove,this),this.prepend=n(this.prepend,this),this.append=n(this.append,this),this.render=n(this.render,this),this.filter=n(this.filter,this);if(!a(t))throw new Error("First argument must be a reference");c+=1,this.instance=c,this.ref=t,this.collection=o.get(t),s(this.collection)||(this.collection=i(t),o.set(t,this.collection)),v=this.control.element.children("[data-item]");for(h=g=0,y=v.length;g<y;h=++g)p=v[h],l=v.eq(h),d=l.data("item")||{},u=f(d),(b=(m=u.metadata).listElements)==null&&(m.listElements={}),u.metadata.listElements[this.instance]=l,this.collection.push(u);(w=this.itemTemplate)==null&&(this.itemTemplate=this.control.template("item")),this.collection.onAppend(this.append),this.collection.onPrepend(this.prepend),this.collection.onRemove(this.remove),this.collection.onUpdate(this.update),this.renderAll()}return e.prototype.filter=function(){return!0},e.prototype.render=function(e){var t,n,r,i,s,u,a,f,c=this,h=this.collection[e];if(!this.filter(o.get(h)))return;this.control.frame.item=h,(a=(i=h.metadata).listElements)==null&&(i.listElements={}),n=this.control.render(this.itemTemplate,o.get(h)),r=h.metadata.listElements[this.instance],h.metadata.listElements[this.instance]=n;if(r!=null){n.insertAfter(r),f=this.control.children;for(s=0,u=f.length;s<u;s++)t=f[s],r===t.element&&(t.destroy(),r=null);r&&r.remove()}else this.control.watchRef(h,function(){return c.render(e),l(c.ref)});return n},e.prototype.append=function(e){var t=this.render(e);if(t!=null)return this.control.element.append(t)},e.prototype.prepend=function(e){var t=this.render(e);if(t!=null)return this.control.element.prepend(t)},e.prototype.remove=function(e){var t,n,r,i,s,o,u;if(((s=e.metadata)!=null?(o=s.listElements)!=null?o[this.instance]:void 0:void 0)==null)return;n=e.metadata.listElements[this.instance],delete e.metadata.listElements[this.instance],u=this.control.children;for(r=0,i=u.length;r<i;r++)t=u[r],n===t.element&&(t.destroy(),n=null);if(n!=null)return n.remove()},e.prototype.renderAll=function(){var e,t,n,r,i,s,o,u;this.control.element.html(""),i=this.collection,u=[];for(e=n=0,r=i.length;n<r;e=++n)t=i[e],((s=t.metadata)!=null?(o=s.listElements)!=null?o[this.instance]:void 0:void 0)!=null?u.push(this.control.element.append(t.metadata.listElements[this.instance])):u.push(this.append(e));return u},e}();t.exports={List:h}}).call(this)}),e.define("/lib/snuggle/control/tree.js",function(e,t){(function(){"use strict";var n=e("./list").List,r=e("../../core/reference"),i=r.isRef,s=r.ref,o=function(){function e(t,r,i){var o,u;this.control=t,u=new n(this.control,r,i),o=this.control.role("children"),o.length>0&&(r.value.children=s(),this.control.cosy.cmd(o,["class",e,r.value.children,u.itemTemplate]))}return e}();t.exports={Tree:o}}).call(this)}),e.define("/lib/window.js",function(e){(function(){"use strict";window.cosy=e("./cosy")}).call(this)}),e("/lib/window.js")})();